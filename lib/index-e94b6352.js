"use strict";var e=require("path"),t=require("child_process"),n=require("./index-3517e75d.js"),r=require("fs"),o=require("os"),i=require("./main-dc18ffab.js"),s=require("assert"),a=require("events"),c=require("buffer"),d=require("stream"),u=require("util");function l(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var p={},m={get exports(){return p},set exports(e){p=e}},f={},g={get exports(){return f},set exports(e){f=e}};const h="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,x=e,y=h?";":":",b=n.isexe_1,v=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),S=(e,t)=>{const n=t.colon||y,r=e.match(/\//)||h&&e.match(/\\/)?[""]:[...h?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(n)],o=h?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",i=h?o.split(n):[""];return h&&-1!==e.indexOf(".")&&""!==i[0]&&i.unshift(""),{pathEnv:r,pathExt:i,pathExtExe:o}},w=(e,t,n)=>{"function"==typeof t&&(n=t,t={}),t||(t={});const{pathEnv:r,pathExt:o,pathExtExe:i}=S(e,t),s=[],a=n=>new Promise(((o,i)=>{if(n===r.length)return t.all&&s.length?o(s):i(v(e));const a=r[n],d=/^".*"$/.test(a)?a.slice(1,-1):a,u=x.join(d,e),l=!d&&/^\.[\\\/]/.test(e)?e.slice(0,2)+u:u;o(c(l,n,0))})),c=(e,n,r)=>new Promise(((d,u)=>{if(r===o.length)return d(a(n+1));const l=o[r];b(e+l,{pathExt:i},((o,i)=>{if(!o&&i){if(!t.all)return d(e+l);s.push(e+l)}return d(c(e,n,r+1))}))}));return n?a(0).then((e=>n(null,e)),n):a(0)};var I=w;w.sync=(e,t)=>{t=t||{};const{pathEnv:n,pathExt:r,pathExtExe:o}=S(e,t),i=[];for(let s=0;s<n.length;s++){const a=n[s],c=/^".*"$/.test(a)?a.slice(1,-1):a,d=x.join(c,e),u=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+d:d;for(let e=0;e<r.length;e++){const n=u+r[e];try{if(b.sync(n,{pathExt:o})){if(!t.all)return n;i.push(n)}}catch(e){}}}if(t.all&&i.length)return i;if(t.nothrow)return null;throw v(e)};var E={};const T=(e={})=>{const t=e.env||process.env;return"win32"!==(e.platform||process.platform)?"PATH":Object.keys(t).reverse().find((e=>"PATH"===e.toUpperCase()))||"Path"};({get exports(){return E},set exports(e){E=e}}).exports=T,E.default=T;const G=e,C=I,P=E;function O(e,t){const n=e.options.env||process.env,r=process.cwd(),o=null!=e.options.cwd,i=o&&void 0!==process.chdir&&!process.chdir.disabled;if(i)try{process.chdir(e.options.cwd)}catch(e){}let s;try{s=C.sync(e.command,{path:n[P({env:n})],pathExt:t?G.delimiter:void 0})}catch(e){}finally{i&&process.chdir(r)}return s&&(s=G.resolve(o?e.options.cwd:"",s)),s}var A=function(e){return O(e)||O(e,!0)},j={};const $=/([()\][%!^"`<>&|;, *?])/g;j.command=function(e){return e=e.replace($,"^$1")},j.argument=function(e,t){return e=(e=`"${e=(e=(e=`${e}`).replace(/(\\*)"/g,'$1$1\\"')).replace(/(\\*)$/,"$1$1")}"`).replace($,"^$1"),t&&(e=e.replace($,"^$1")),e};const _=/^#!(.*)/;const R=r,B=(e="")=>{const t=e.match(_);if(!t)return null;const[n,r]=t[0].replace(/#! ?/,"").split(" "),o=n.split("/").pop();return"env"===o?r:r?`${o} ${r}`:o};var L=function(e){const t=Buffer.alloc(150);let n;try{n=R.openSync(e,"r"),R.readSync(n,t,0,150,0),R.closeSync(n)}catch(e){}return B(t.toString())};const N=e,k=A,M=j,U=L,D="win32"===process.platform,F=/\.(?:com|exe)$/i,q=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function H(e){if(!D)return e;const t=function(e){e.file=k(e);const t=e.file&&U(e.file);return t?(e.args.unshift(e.file),e.command=t,k(e)):e.file}(e),n=!F.test(t);if(e.options.forceShell||n){const n=q.test(t);e.command=N.normalize(e.command),e.command=M.command(e.command),e.args=e.args.map((e=>M.argument(e,n)));const r=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${r}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}var K=function(e,t,n){t&&!Array.isArray(t)&&(n=t,t=null);const r={command:e,args:t=t?t.slice(0):[],options:n=Object.assign({},n),file:void 0,original:{command:e,args:t}};return n.shell?r:H(r)};const X="win32"===process.platform;function V(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function W(e,t){return X&&1===e&&!t.file?V(t.original,"spawn"):null}var Y={hookChildProcess:function(e,t){if(!X)return;const n=e.emit;e.emit=function(r,o){if("exit"===r){const r=W(o,t);if(r)return n.call(e,"error",r)}return n.apply(e,arguments)}},verifyENOENT:W,verifyENOENTSync:function(e,t){return X&&1===e&&!t.file?V(t.original,"spawnSync"):null},notFoundError:V};const z=t,Z=K,Q=Y;function J(e,t,n){const r=Z(e,t,n),o=z.spawn(r.command,r.args,r.options);return Q.hookChildProcess(o,r),o}g.exports=J,f.spawn=J,f.sync=function(e,t,n){const r=Z(e,t,n),o=z.spawnSync(r.command,r.args,r.options);return o.error=o.error||Q.verifyENOENTSync(o.status,r),o},f._parse=Z,f._enoent=Q;var ee={};!function(t){const n=e,r=E,o=e=>{let t;e={cwd:process.cwd(),path:process.env[r()],execPath:process.execPath,...e};let o=n.resolve(e.cwd);const i=[];for(;t!==o;)i.push(n.join(o,"node_modules/.bin")),t=o,o=n.resolve(o,"..");const s=n.resolve(e.cwd,e.execPath,"..");return i.push(s),i.concat(e.path).join(n.delimiter)};t.exports=o,t.exports.default=o,t.exports.env=e=>{const n={...(e={env:process.env,...e}).env},o=r({env:n});return e.path=n[o],n[o]=t.exports(e),n}}({get exports(){return ee},set exports(e){ee=e}});var te={},ne={get exports(){return te},set exports(e){te=e}},re={};const oe=(e,t)=>{for(const n of Reflect.ownKeys(t))Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n));return e};({get exports(){return re},set exports(e){re=e}}).exports=oe,re.default=oe;const ie=re,se=new WeakMap,ae=(e,t={})=>{if("function"!=typeof e)throw new TypeError("Expected a function");let n,r=0;const o=e.displayName||e.name||"<anonymous>",i=function(...s){if(se.set(i,++r),1===r)n=e.apply(this,s),e=null;else if(!0===t.throw)throw new Error(`Function \`${o}\` can only be called once`);return n};return ie(i,e),se.set(i,r),i};ne.exports=ae,te.default=ae,te.callCount=e=>{if(!se.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return se.get(e)};var ce={},de={},ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.SIGNALS=void 0;ue.SIGNALS=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.SIGRTMAX=le.getRealtimeSignals=void 0;le.getRealtimeSignals=function(){const e=fe-me+1;return Array.from({length:e},pe)};const pe=function(e,t){return{name:`SIGRT${t+1}`,number:me+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},me=34,fe=64;le.SIGRTMAX=fe,Object.defineProperty(de,"__esModule",{value:!0}),de.getSignals=void 0;var ge=o,he=ue,xe=le;de.getSignals=function(){const e=(0,xe.getRealtimeSignals)();return[...he.SIGNALS,...e].map(ye)};const ye=function({name:e,number:t,description:n,action:r,forced:o=!1,standard:i}){const{signals:{[e]:s}}=ge.constants,a=void 0!==s;return{name:e,number:a?s:t,description:n,supported:a,action:r,forced:o,standard:i}};Object.defineProperty(ce,"__esModule",{value:!0}),ce.signalsByNumber=ce.signalsByName=void 0;var be=o,ve=de,Se=le;const we=function(e,{name:t,number:n,description:r,supported:o,action:i,forced:s,standard:a}){return{...e,[t]:{name:t,number:n,description:r,supported:o,action:i,forced:s,standard:a}}},Ie=(0,ve.getSignals)().reduce(we,{});ce.signalsByName=Ie;const Ee=function(e,t){const n=Te(e,t);if(void 0===n)return{};const{name:r,description:o,supported:i,action:s,forced:a,standard:c}=n;return{[e]:{name:r,number:e,description:o,supported:i,action:s,forced:a,standard:c}}},Te=function(e,t){const n=t.find((({name:t})=>be.constants.signals[t]===e));return void 0!==n?n:t.find((t=>t.number===e))},Ge=function(){const e=(0,ve.getSignals)(),t=Se.SIGRTMAX+1,n=Array.from({length:t},((t,n)=>Ee(n,e)));return Object.assign({},...n)}();ce.signalsByNumber=Ge;const{signalsByName:Ce}=ce;var Pe=({stdout:e,stderr:t,all:n,error:r,signal:o,exitCode:i,command:s,escapedCommand:a,timedOut:c,isCanceled:d,killed:u,parsed:{options:{timeout:l}}})=>{i=null===i?void 0:i;const p=void 0===(o=null===o?void 0:o)?void 0:Ce[o].description,m=(({timedOut:e,timeout:t,errorCode:n,signal:r,signalDescription:o,exitCode:i,isCanceled:s})=>e?`timed out after ${t} milliseconds`:s?"was canceled":void 0!==n?`failed with ${n}`:void 0!==r?`was killed with ${r} (${o})`:void 0!==i?`failed with exit code ${i}`:"failed")({timedOut:c,timeout:l,errorCode:r&&r.code,signal:o,signalDescription:p,exitCode:i,isCanceled:d}),f=`Command ${m}: ${s}`,g="[object Error]"===Object.prototype.toString.call(r),h=g?`${f}\n${r.message}`:f,x=[h,t,e].filter(Boolean).join("\n");return g?(r.originalMessage=r.message,r.message=x):r=new Error(x),r.shortMessage=h,r.command=s,r.escapedCommand=a,r.exitCode=i,r.signal=o,r.signalDescription=p,r.stdout=e,r.stderr=t,void 0!==n&&(r.all=n),"bufferedData"in r&&delete r.bufferedData,r.failed=!0,r.timedOut=Boolean(c),r.isCanceled=d,r.killed=u&&!c,r},Oe={};const Ae=["stdin","stdout","stderr"],je=e=>{if(!e)return;const{stdio:t}=e;if(void 0===t)return Ae.map((t=>e[t]));if((e=>Ae.some((t=>void 0!==e[t])))(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Ae.map((e=>`\`${e}\``)).join(", ")}`);if("string"==typeof t)return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);const n=Math.max(t.length,Ae.length);return Array.from({length:n},((e,n)=>t[n]))};({get exports(){return Oe},set exports(e){Oe=e}}).exports=je,Oe.node=e=>{const t=je(e);return"ipc"===t?"ipc":void 0===t||"string"==typeof t?[t,t,t,"ipc"]:t.includes("ipc")?t:[...t,"ipc"]};var $e,_e={},Re={get exports(){return _e},set exports(e){_e=e}},Be={},Le={get exports(){return Be},set exports(e){Be=e}};var Ne=i.commonjsGlobal.process;const ke=function(e){return e&&"object"==typeof e&&"function"==typeof e.removeListener&&"function"==typeof e.emit&&"function"==typeof e.reallyExit&&"function"==typeof e.listeners&&"function"==typeof e.kill&&"number"==typeof e.pid&&"function"==typeof e.on};if(ke(Ne)){var Me,Ue=s,De=($e||($e=1,(Je=Le).exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],"win32"!==process.platform&&Je.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),"linux"===process.platform&&Je.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")),Be),Fe=/^win/i.test(Ne.platform),qe=a;"function"!=typeof qe&&(qe=qe.EventEmitter),Ne.__signal_exit_emitter__?Me=Ne.__signal_exit_emitter__:((Me=Ne.__signal_exit_emitter__=new qe).count=0,Me.emitted={}),Me.infinite||(Me.setMaxListeners(1/0),Me.infinite=!0),Re.exports=function(e,t){if(!ke(i.commonjsGlobal.process))return function(){};Ue.equal(typeof e,"function","a callback must be provided for exit handler"),!1===Ve&&We();var n="exit";t&&t.alwaysLast&&(n="afterexit");return Me.on(n,e),function(){Me.removeListener(n,e),0===Me.listeners("exit").length&&0===Me.listeners("afterexit").length&&He()}};var He=function(){Ve&&ke(i.commonjsGlobal.process)&&(Ve=!1,De.forEach((function(e){try{Ne.removeListener(e,Xe[e])}catch(e){}})),Ne.emit=Ze,Ne.reallyExit=Ye,Me.count-=1)};_e.unload=He;var Ke=function(e,t,n){Me.emitted[e]||(Me.emitted[e]=!0,Me.emit(e,t,n))},Xe={};De.forEach((function(e){Xe[e]=function(){ke(i.commonjsGlobal.process)&&(Ne.listeners(e).length===Me.count&&(He(),Ke("exit",null,e),Ke("afterexit",null,e),Fe&&"SIGHUP"===e&&(e="SIGINT"),Ne.kill(Ne.pid,e)))}})),_e.signals=function(){return De};var Ve=!1,We=function(){!Ve&&ke(i.commonjsGlobal.process)&&(Ve=!0,Me.count+=1,De=De.filter((function(e){try{return Ne.on(e,Xe[e]),!0}catch(e){return!1}})),Ne.emit=Qe,Ne.reallyExit=ze)};_e.load=We;var Ye=Ne.reallyExit,ze=function(e){ke(i.commonjsGlobal.process)&&(Ne.exitCode=e||0,Ke("exit",Ne.exitCode,null),Ke("afterexit",Ne.exitCode,null),Ye.call(Ne,Ne.exitCode))},Ze=Ne.emit,Qe=function(e,t){if("exit"===e&&ke(i.commonjsGlobal.process)){void 0!==t&&(Ne.exitCode=t);var n=Ze.apply(this,arguments);return Ke("exit",Ne.exitCode,null),Ke("afterexit",Ne.exitCode,null),n}return Ze.apply(this,arguments)}}else Re.exports=function(){return function(){}};var Je;const et=o,tt=_e,nt=(e,t,n,r)=>{if(!rt(t,n,r))return;const o=it(n),i=setTimeout((()=>{e("SIGKILL")}),o);i.unref&&i.unref()},rt=(e,{forceKillAfterTimeout:t},n)=>ot(e)&&!1!==t&&n,ot=e=>e===et.constants.signals.SIGTERM||"string"==typeof e&&"SIGTERM"===e.toUpperCase(),it=({forceKillAfterTimeout:e=!0})=>{if(!0===e)return 5e3;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e};var st={spawnedKill:(e,t="SIGTERM",n={})=>{const r=e(t);return nt(e,t,n,r),r},spawnedCancel:(e,t)=>{e.kill()&&(t.isCanceled=!0)},setupTimeout:(e,{timeout:t,killSignal:n="SIGTERM"},r)=>{if(0===t||void 0===t)return r;let o;const i=new Promise(((r,i)=>{o=setTimeout((()=>{((e,t,n)=>{e.kill(t),n(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))})(e,n,i)}),t)})),s=r.finally((()=>{clearTimeout(o)}));return Promise.race([i,s])},validateTimeout:({timeout:e})=>{if(void 0!==e&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},setExitHandler:async(e,{cleanup:t,detached:n},r)=>{if(!t||n)return r;const o=tt((()=>{e.kill()}));return r.finally((()=>{o()}))}};const at=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;at.writable=e=>at(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,at.readable=e=>at(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,at.duplex=e=>at.writable(e)&&at.readable(e),at.transform=e=>at.duplex(e)&&"function"==typeof e._transform;var ct=at,dt={},ut={get exports(){return dt},set exports(e){dt=e}};const{PassThrough:lt}=d;const{constants:pt}=c,mt=d,{promisify:ft}=u,gt=e=>{e={...e};const{array:t}=e;let{encoding:n}=e;const r="buffer"===n;let o=!1;t?o=!(n||r):n=n||"utf8",r&&(n=null);const i=new lt({objectMode:o});n&&i.setEncoding(n);let s=0;const a=[];return i.on("data",(e=>{a.push(e),o?s=a.length:s+=e.length})),i.getBufferedValue=()=>t?a:r?Buffer.concat(a,s):a.join(""),i.getBufferedLength=()=>s,i},ht=ft(mt.pipeline);class xt extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function yt(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};const{maxBuffer:n}=t,r=gt(t);return await new Promise(((t,o)=>{const i=e=>{e&&r.getBufferedLength()<=pt.MAX_LENGTH&&(e.bufferedData=r.getBufferedValue()),o(e)};(async()=>{try{await ht(e,r),t()}catch(e){i(e)}})(),r.on("data",(()=>{r.getBufferedLength()>n&&i(new xt)}))})),r.getBufferedValue()}ut.exports=yt,dt.buffer=(e,t)=>yt(e,{...t,encoding:"buffer"}),dt.array=(e,t)=>yt(e,{...t,array:!0}),dt.MaxBufferError=xt;const{PassThrough:bt}=d;const vt=ct,St=dt,wt=function(){var e=[],t=new bt({objectMode:!0});return t.setMaxListeners(0),t.add=n,t.isEmpty=function(){return 0==e.length},t.on("unpipe",r),Array.prototype.slice.call(arguments).forEach(n),t;function n(o){return Array.isArray(o)?(o.forEach(n),this):(e.push(o),o.once("end",r.bind(null,o)),o.once("error",t.emit.bind(t,"error")),o.pipe(t,{end:!1}),this)}function r(n){!(e=e.filter((function(e){return e!==n}))).length&&t.readable&&t.end()}},It=async(e,t)=>{if(e){e.destroy();try{return await t}catch(e){return e.bufferedData}}},Et=(e,{encoding:t,buffer:n,maxBuffer:r})=>{if(e&&n)return t?St(e,{encoding:t,maxBuffer:r}):St.buffer(e,{maxBuffer:r})};var Tt={handleInput:(e,t)=>{void 0!==t&&void 0!==e.stdin&&(vt(t)?t.pipe(e.stdin):e.stdin.end(t))},makeAllStream:(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;const n=wt();return e.stdout&&n.add(e.stdout),e.stderr&&n.add(e.stderr),n},getSpawnedResult:async({stdout:e,stderr:t,all:n},{encoding:r,buffer:o,maxBuffer:i},s)=>{const a=Et(e,{encoding:r,buffer:o,maxBuffer:i}),c=Et(t,{encoding:r,buffer:o,maxBuffer:i}),d=Et(n,{encoding:r,buffer:o,maxBuffer:2*i});try{return await Promise.all([s,a,c,d])}catch(r){return Promise.all([{error:r,signal:r.signal,timedOut:r.timedOut},It(e,a),It(t,c),It(n,d)])}},validateInputSync:({input:e})=>{if(vt(e))throw new TypeError("The `input` option cannot be a stream in sync mode")}};const Gt=(async()=>{})().constructor.prototype,Ct=["then","catch","finally"].map((e=>[e,Reflect.getOwnPropertyDescriptor(Gt,e)]));var Pt={mergePromise:(e,t)=>{for(const[n,r]of Ct){const o="function"==typeof t?(...e)=>Reflect.apply(r.value,t(),e):r.value.bind(t);Reflect.defineProperty(e,n,{...r,value:o})}return e},getSpawnedPromise:e=>new Promise(((t,n)=>{e.on("exit",((e,n)=>{t({exitCode:e,signal:n})})),e.on("error",(e=>{n(e)})),e.stdin&&e.stdin.on("error",(e=>{n(e)}))}))};const Ot=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],At=/^[\w.-]+$/,jt=/"/g,$t=/ +/g;var _t={joinCommand:(e,t)=>Ot(e,t).join(" "),getEscapedCommand:(e,t)=>Ot(e,t).map((e=>(e=>"string"!=typeof e||At.test(e)?e:`"${e.replace(jt,'\\"')}"`)(e))).join(" "),parseCommand:e=>{const t=[];for(const n of e.trim().split($t)){const e=t[t.length-1];e&&e.endsWith("\\")?t[t.length-1]=`${e.slice(0,-1)} ${n}`:t.push(n)}return t}};const Rt=e,Bt=t,Lt=f,Nt=e=>{const t="string"==typeof e?"\n":"\n".charCodeAt(),n="string"==typeof e?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,e.length-1)),e[e.length-1]===n&&(e=e.slice(0,e.length-1)),e},kt=ee,Mt=te,Ut=Pe,Dt=Oe,{spawnedKill:Ft,spawnedCancel:qt,setupTimeout:Ht,validateTimeout:Kt,setExitHandler:Xt}=st,{handleInput:Vt,getSpawnedResult:Wt,makeAllStream:Yt,validateInputSync:zt}=Tt,{mergePromise:Zt,getSpawnedPromise:Qt}=Pt,{joinCommand:Jt,parseCommand:en,getEscapedCommand:tn}=_t,nn=(e,t,n={})=>{const r=Lt._parse(e,t,n);return e=r.command,t=r.args,(n={maxBuffer:1e8,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:(n=r.options).cwd||process.cwd(),execPath:process.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...n}).env=(({env:e,extendEnv:t,preferLocal:n,localDir:r,execPath:o})=>{const i=t?{...process.env,...e}:e;return n?kt.env({env:i,cwd:r,execPath:o}):i})(n),n.stdio=Dt(n),"win32"===process.platform&&"cmd"===Rt.basename(e,".exe")&&t.unshift("/q"),{file:e,args:t,options:n,parsed:r}},rn=(e,t,n)=>"string"==typeof t||Buffer.isBuffer(t)?e.stripFinalNewline?Nt(t):t:void 0===n?void 0:"",on=(e,t,n)=>{const r=nn(e,t,n),o=Jt(e,t),i=tn(e,t);let s;Kt(r.options);try{s=Bt.spawn(r.file,r.args,r.options)}catch(e){const t=new Bt.ChildProcess,n=Promise.reject(Ut({error:e,stdout:"",stderr:"",all:"",command:o,escapedCommand:i,parsed:r,timedOut:!1,isCanceled:!1,killed:!1}));return Zt(t,n)}const a=Qt(s),c=Ht(s,r.options,a),d=Xt(s,r.options,c),u={isCanceled:!1};s.kill=Ft.bind(null,s.kill.bind(s)),s.cancel=qt.bind(null,s,u);const l=Mt((async()=>{const[{error:e,exitCode:t,signal:n,timedOut:a},c,l,p]=await Wt(s,r.options,d),m=rn(r.options,c),f=rn(r.options,l),g=rn(r.options,p);if(e||0!==t||null!==n){const c=Ut({error:e,exitCode:t,signal:n,stdout:m,stderr:f,all:g,command:o,escapedCommand:i,parsed:r,timedOut:a,isCanceled:u.isCanceled,killed:s.killed});if(!r.options.reject)return c;throw c}return{command:o,escapedCommand:i,exitCode:0,stdout:m,stderr:f,all:g,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}));return Vt(s,r.options.input),s.all=Yt(s,r.options),Zt(s,l)};m.exports=on;var sn=p.sync=(e,t,n)=>{const r=nn(e,t,n),o=Jt(e,t),i=tn(e,t);let s;zt(r.options);try{s=Bt.spawnSync(r.file,r.args,r.options)}catch(e){throw Ut({error:e,stdout:"",stderr:"",all:"",command:o,escapedCommand:i,parsed:r,timedOut:!1,isCanceled:!1,killed:!1})}const a=rn(r.options,s.stdout,s.error),c=rn(r.options,s.stderr,s.error);if(s.error||0!==s.status||null!==s.signal){const e=Ut({stdout:a,stderr:c,error:s.error,signal:s.signal,exitCode:s.status,command:o,escapedCommand:i,parsed:r,timedOut:s.error&&"ETIMEDOUT"===s.error.code,isCanceled:!1,killed:null!==s.signal});if(!r.options.reject)return e;throw e}return{command:o,escapedCommand:i,exitCode:0,stdout:a,stderr:c,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}},an=p.command=(e,t)=>{const[n,...r]=en(e);return on(n,r,t)},cn=p.commandSync=(e,t)=>{const[n,...r]=en(e);return on.sync(n,r,t)},dn=p.node=(e,t,n={})=>{t&&!Array.isArray(t)&&"object"==typeof t&&(n=t,t=[]);const r=Dt.node(n),o=process.execArgv.filter((e=>!e.startsWith("--inspect"))),{nodePath:i=process.execPath,nodeOptions:s=o}=n;return on(i,[...s,e,...Array.isArray(t)?t:[]],{...n,stdin:void 0,stdout:void 0,stderr:void 0,stdio:r,shell:!1})},un=l({__proto__:null,command:an,commandSync:cn,get default(){return p},node:dn,sync:sn},[p]);exports.index=un;
//# sourceMappingURL=index-e94b6352.js.map
