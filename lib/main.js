module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){var i,o,s;({readManifestSync:s}=n(3)),o=s("language-nsis"),e.exports=i={clearConsole:function(e){try{return e.clear()}catch(e){if(i.getConfig("clearConsole"))return console.clear()}},detectOutfile:function(e){return-1!==e.indexOf('Output: "')?/Output: \"(.*\.exe)\"\r?\n/g.exec(e.toString())[1]:""},getConfig:function(e=""){return null!=e?atom.config.get(`${o.name}.${e}`):atom.config.get(`${o.name}`)},getMakensisPath:function(e){var t,o,s;return({spawn:o}=n(1)),(t=i.getConfig("pathToMakensis")).length>0&&"makensis"!==t?e(t):((s=o(i.which(),["makensis"])).stdout.on("data",function(t){var n;return n=t.toString().trim(),atom.config.set("language-nsis.pathToMakensis",n),e(n)}),s.on("close",function(e){if(e>0)return atom.notifications.addError("**language-nsis**: makensis is not in your `PATH` [environmental variable](http://superuser.com/a/284351/195953)",{dismissable:!0})}))},getPrefix:function(){var e;return({platform:e}=n(2)),"win32"===e()?"/":"-"},isWindowsCompatible:function(){var e;return({platform:e}=n(2)),"win32"===e()||!0===i.getConfig("useWineToRun")},logCompilerFlags:function(e,t,n){var o;if(o=!0===t?JSON.stringify(e.stdout,null,2):e.stdout,"console"!==i.getConfig("compilerOutput").toLowerCase())return atom.notifications.addInfo("**language-nsis**",{detail:o,dismissable:!0});try{return n.raw(o)}catch(e){return console.info(o),atom.getCurrentWindow().openDevTools()}},notifyOnCompletion:function(e,t,n){var o,s,a,r,c;return o=[],a=!1,n&&("Run"===t&&(a=!0,t={text:t,className:"icon icon-playback-play",onDidClick:function(){return r.dismiss(),i.runInstaller(n)}},o.push(t)),c={text:"Reveal",className:"icon icon-location",onDidClick:function(){return r.dismiss(),i.revealInstaller(n)}},s={text:"Cancel",onDidClick:function(){return r.dismiss()}},o.push(c),o.push(s)),r="warning"===e?atom.notifications.addWarning("Compiled with warnings",{dismissable:a,buttons:o}):atom.notifications.addSuccess("Compiled successfully",{dismissable:a,buttons:o})},openSettings:function(){var e;return e={pending:!0,searchAllPanes:!0},atom.workspace.open(`atom://config/packages/${o.name}`,e)},openURL:function(e){return n(9)(`https://idleberg.github.io/NSIS.docset/Contents/Resources/Documents/html/Reference/${e}.html?utm_source=atom&utm_content=reference`,{url:!0})},revealInstaller:function(e){var t,i,o,s;return({access:i,existsSync:o,F_OK:t}=n(5)),({shell:s}=n(10)),i(e,t,function(t){return t||""===e?console.log(t):s.showItemInFolder(e)})},runInstaller:function(e){var t,o,s,a;if(({exec:o,spawn:a}=n(1)),({platform:s}=n(2)),"win32"===s())try{return o(`cmd /c "${e}"`)}catch(e){return t=e,atom.notifications.addWarning("**language-nsis**",{detail:t,dismissable:!0})}else if(!0===i.getConfig("useWineToRun"))try{return a("wine",[e])}catch(e){return t=e,atom.notifications.addWarning("**language-nsis**",{detail:t,dismissable:!0})}},which:function(){var e;return({platform:e}=n(2)),"win32"===e()?"where":"which"}}},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("atom-read-manifest")},function(e,t){e.exports=require("makensis")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t,n){var i,o;({readManifestSync:o}=n(3)),i=o("language-nsis"),e.exports={compile:function(e,t){var o,s,a,r,c,l,u,d,m,p,f,g;return({spawn:g}=n(1)),({clearConsole:o,detectOutfile:s,getConfig:r,getMakensisPath:c,getPrefix:l,isWindowsCompatible:u,notifyOnCompletion:m}=n(0)),null==(a=atom.workspace.getActiveTextEditor())?atom.notifications.addWarning(`**${i.name}**: No active editor`,{dismissable:!1}):(f=a.getPath(),p=a.getGrammar().scopeName,!1===r("allowHeaderCompilation")&&f.endsWith("nsh")?(d=atom.notifications.addWarning("Compiling header files is blocked by default. You can allow it in the package settings.",{dismissable:!0,buttons:[{text:"Open Settings",className:"icon icon-gear",onDidClick:function(){return atom.workspace.open("atom://config/packages/language-nsis",{pending:!0,searchAllPanes:!0}),d.dismiss()}},{text:"Cancel",onDidClick:function(){return d.dismiss()}}]}),atom.beep()):null!=f&&p.startsWith("source.nsis")?a.save().then(function(){return c(function(n){var i,a,c,d,p;return p=l(),i=r("compilerArguments"),!0!==e||i.includes("-WX")||i.includes("/WX")||i.push(`${p}WX`),i.push(f),o(t),c=g(n,i),a=!1,d="",c.stdout.on("data",function(e){var n;if(n=e.toString(),!1===a&&-1!==e.indexOf("warning: ")){a=!0;try{r("alwaysShowOutput")&&t.warn(n)}catch(e){console.warn(n)}}else try{r("alwaysShowOutput")&&t.log(n)}catch(e){console.log(n)}if(""===d)return d=s(e)}),c.stderr.on("data",function(e){var n;n=e.toString();try{return t.error(n)}catch(e){return console.error(n)}}),c.on("close",function(e){var t;if(0===e){if(t=!0===u()?"Run":"",!0===a&&r("showBuildNotifications"))return m("warning",t,d);if(r("showBuildNotifications"))return m("success",t,d)}if(r("showBuildNotifications"))return atom.notifications.addError("Compile Error",{dismissable:!1})})})}):atom.beep())},showVersion:function(e){var t,o,s,a,r,c;return({spawn:r}=n(1)),({clearConsole:t,getConfig:o,getMakensisPath:s,getPrefix:a}=n(0)),({version:c}=n(4)),s(function(n){return t(e),c({pathToMakensis:n}).then(function(t){if("console"===o("compilerOutput").toLowerCase())try{e.log(`makensis ${t.stdout} (${n})`)}catch(e){console.info(`makensis ${t.stdout} (${n})`),atom.getCurrentWindow().openDevTools()}else atom.notifications.addInfo(`**${i.name}**`,{detail:`makensis ${t.stdout} (${n})`,dismissable:!0})}).catch(function(e){return console.error(e)})})},showCompilerFlags:function(e){var t,i,o,s,a,r,c,l;return({spawn:l}=n(1)),({clearConsole:t,getConfig:i,getMakensisPath:o,getPrefix:s,logCompilerFlags:r}=n(0)),({hdrInfo:a}=n(4)),(c=i("showFlagsAsObject"))&&" (JSON)",o(function(n){return t(e),a({pathToMakensis:n,json:c}).then(function(t){return r(t,c,e)}).catch(function(t){return r(t,c,e)})})},showHelp:function(e){var t,i,o,s,a,r,c;return({spawn:c}=n(1)),({clearConsole:t,getConfig:o,getMakensisPath:s,getPrefix:a,logCompilerFlags:r}=n(0)),({cmdHelp:i}=n(4)),s(function(t){return i("",{pathToMakensis:t,json:!0}).then(function(t){return e.update({items:Object.keys(t.stdout)})}).catch(function(t){return e.update({items:Object.keys(t.stdout)})})})}}},function(e,t,n){var i,o,s,a;({getConfig:i,getPrefix:o,openSettings:s}=n(0)),({satisfyDependencies:a}=n(11)),e.exports={config:{pathToMakensis:{title:"Path To MakeNSIS",description:"Specify the full path to `makensis`",type:"string",default:"makensis",order:0},compilerArguments:{title:"Compiler Arguments",description:"Specify the default arguments for `makensis`, separated by commas ([see documentation](http://nsis.sourceforge.net/Docs/Chapter3.html#usage))",type:"array",default:[`${o()}V3`],items:{type:"string"},order:1},alwaysShowOutput:{title:"Always Show Output",description:"Displays compiler output in console panel. When deactivated, it will only show on errors",type:"boolean",default:!0,order:2},showBuildNotifications:{title:"Show Build Notifications",description:"Displays color-coded notifications that close automatically after 5 seconds",type:"boolean",default:!0,order:3},clearConsole:{title:"Clear Console",description:"When `console-panel` isn't available, build logs will be printed using `console.log()`. This setting clears the console prior to building.",type:"boolean",default:!0,order:4},allowHeaderCompilation:{title:"Allow Header Compilation",description:"By default, only `.nsi` files will be compiled. This setting enables it for `.nsh` files as well.",type:"boolean",default:!1,order:5},showFlagsAsObject:{title:"Show Flags as Object",description:"Displays compiler flags as JSON",type:"boolean",default:!0,order:6},buildFileSyntax:{title:"Build File Syntax",description:"Specify the default syntax for your build file (requires [build](https://atom.io/packages/build))",type:"string",default:"json",enum:[{value:"cson",description:"CSON"},{value:"json",description:"JSON"},{value:"yaml",description:"YAML"}],order:7},compilerOutput:{title:"Compiler Output",description:"Specify whether `makensis` outputs its version or compiler flags to notifications the console",type:"string",default:"notification",enum:[{value:"notification",description:"Notification"},{value:"console",description:"Console"}],order:8},useWineToRun:{title:"Use Wine to run",description:"When on a non-Windows platform, you can run compiled installers using [Wine](https://www.winehq.org/)",type:"boolean",default:!1,order:9},manageDependencies:{title:"Manage Dependencies",description:"When enabled, third-party dependencies will be installed automatically",type:"boolean",default:!0,order:10}},subscriptions:null,activate:function(e){var t,o,r,c,l,u;if(({CompositeDisposable:o}=n(12)),t=n(13),r=n(16),c=n(7),l=n(18),u=n(20),this.subscriptions=new o,this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:save-&-compile":()=>c.compile(!1,this.consolePanel)})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:save-&-compile-strict":()=>c.compile(!0,this.consolePanel)})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:show-version":()=>c.showVersion(this.consolePanel)})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:show-compiler-flags":()=>c.showCompilerFlags(this.consolePanel)})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:open-package-settings":function(){return s()}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:satisfy-package-dependencies":function(){return a("language-nsis")}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:create-.atom–build-file":function(){return t.createFile(!1)}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:create-.atom–build-file-for-wine":function(){return t.createFile(!0)}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:set-default-runner":function(){return u.set()}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:remove-default-runner":function(){return u.remove()}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:command-reference":function(){return r.init(),r.toggle()}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"NSIS:convert-language-file":function(){return l.convert()}})),!0===i("manageDependencies"))return a(n(21),{showPrompt:!0})},deactivate:function(){var e;return null!=(e=this.subscriptions)&&e.dispose(),this.subscriptions=null},consumeConsolePanel:function(e){this.consolePanel=e}}},function(e,t){e.exports=require("open")},function(e,t){e.exports=require("electron")},function(e,t){e.exports=require("atom-satisfy-dependencies")},function(e,t){e.exports=require("atom")},function(e,t,n){e.exports={createFile:function(e){var t,i,o,s,a,r,c,l,u,d,m;if(l=n(5),d=n(6),({getConfig:u}=n(0)),null!=(c=atom.workspace.getActiveTextEditor())){if("source.nsis"===c.getGrammar().scopeName)return s=!1,r=atom.workspace.getActivePaneItem().getPath(),a=d.basename(r),void 0===r?atom.confirm({message:"File not saved",detailedMessage:"You need to save this file before you can create a build-file",buttons:{OK:function(){}}}):(m=null,r=d.dirname(r),o=u("buildFileSyntax"),t="CSON"===o?".atom-build.cson":"YAML"===o?".atom-build.yml":".atom-build.json",i=d.join(r,t),l.access(`${i}`,l.constants.R_OK,function(r){var c,u,p,f,g,h;if(null===r?atom.confirm({message:"File exists",detailedMessage:"Do you really want to overwrite your existing build file?",buttons:{Overwrite:function(){return m="Overwriting existing file",s=!0},Abort:function(){}}}):(m="Saving file",s=!0),!0===s){switch(!0!==e?(u="makensis",g=!1):(f=atom.config.get("build-makensis-wine.pathToScript"),p=atom.packages.getPackageDirPaths().toString(),u=f?`"${f}"`:d.join(p,"build-makensis-wine","lib","makensis-wine.sh"),g=!0),c={name:`${a}`,cmd:u,args:["{FILE_ACTIVE}"],sh:g,cwd:"{FILE_ACTIVE_PATH}",errorMatch:'(\\r?\\n)(?<message>.+)(\\r?\\n)Error in script "(?<file>[^"]+)" on line (?<line>\\d+) -- aborting creation process',warningMatch:"[^!]warning: (?<message>.*) \\((?<file>(\\w{1}:)?[^:]+):(?<line>\\d+)\\)"},o){case"CSON":h=n(14).stringify(c,null,2);break;case"YAML":h=n(15).dump(c);break;default:h=JSON.stringify(c,null,2)}return l.writeFile(i,h,function(e){return e?atom.notifications.addError(t,{detail:e,dismissable:!1}):(atom.notifications.addInfo(t,{detail:m,dismissable:!1}),atom.workspace.open(i))})}}));atom.notifications.addWarning("**language-nsis**: Unsupported document type",{dismissable:!1})}else atom.notifications.addWarning("**language-nsis**: No active editor",{dismissable:!1})}}},function(e,t){e.exports=require("cson-parser")},function(e,t){e.exports=require("yaml-js")},function(e,t,n){var i;i=n(17),e.exports={init:function(){return this.selectListView=new i({emptyMessage:"No command matches your search.",items:[],filterKeyForItem:function(e){return e},elementForItem:function(e){var t,n;return n=e,(t=document.createElement("li")).innerHTML=n,t},didConfirmSelection:e=>{var t;return({openURL:t}=n(0)),this.cancel(),t(e)},didCancelSelection:()=>this.cancel()}),this.selectListView.element.classList.add("nsis-command-list")},dispose:function(){return this.cancel(),this.selectListView.destroy()},cancel:function(){if(null!=this.panel&&this.panel.destroy(),this.panel=null,this.previouslyFocusedElement)return this.previouslyFocusedElement.focus(),this.previouslyFocusedElement=null},attach:function(){return this.previouslyFocusedElement=document.activeElement,null==this.panel&&(this.panel=atom.workspace.addModalPanel({item:this.selectListView})),this.selectListView.focus(),this.selectListView.reset()},toggle:function(){var e;return null!=this.panel?this.cancel():(({showHelp:e}=n(7)),e(this.selectListView),this.attach())}}},function(e,t){e.exports=require("atom-select-list")},function(e,t,n){var i;i=n(19),e.exports={convert:function(){var e;return null==(e=atom.workspace.getActiveTextEditor())?atom.beep():"source.nlf"===e.getGrammar().scopeName?this.convertNLF(e):"source.json"===e.getGrammar().scopeName?this.convertJSON(e):atom.beep()},convertNLF:function(e){var t,n,o;try{n=e.getText(),o=i.parse(n,{stringify:!0})}catch(e){return t=e,console.error(t),atom.notifications.addError("Conversion Failed",{detail:t,dismissable:!0})}return this.openNewFile(e,o,"json")},convertJSON:function(e){var t,n,o;try{n=e.getText(),o=i.stringify(n)}catch(e){return t=e,console.error(t),atom.notifications.addError("Conversion Failed",{detail:t,dismissable:!0})}return this.openNewFile(e,o,"nlf")},openNewFile:function(e,t,i){var o,s,a,r;return({basename:o,extname:s}=n(6)),r=o(a=e.getFileName().toString(),s(a)),atom.workspace.open(`${r}.${i}`,{pending:!0}).then(function(e){return e.setText(t)}).catch(function(e){return atom.notifications.addError(e,{dismissable:!0})})}}},function(e,t){e.exports=require("@nsis/nlf")},function(e,t,n){var i,o;({readManifestSync:o}=n(3)),i=o("language-nsis"),e.exports={runner:null,set:function(){return this.check(),void 0!==this.runner.path&&!0===this.runner.active?atom.confirm({message:"Set default runner for NSIS",detailedMessage:"To compile NSIS scripts inside Atom, you need to define a runner. Do you want to use makensis as default runner?",buttons:{"Use makensis":function(){return atom.notifications.addSuccess(`**${i.name}**: Set \`runner.scopes.nsis\` to 'makensis -'`,{dismissable:!1}),atom.config.set("runner.scopes.nsis","makensis -")},Cancel:function(){atom.notifications.addWarning(`**${i.name}**: Cancelled setting default runner`,{dismissable:!1})}}}):this.notify()},remove:function(){return this.check(),void 0!==this.runner.path&&!0===this.runner.active?(atom.notifications.addSuccess(`**${i.name}**: Unset \`runner.scopes.nsis\``,{dismissable:!1}),atom.config.unset("runner.scopes.nsis")):this.notify()},notify:function(){return atom.notifications.addWarning(`**${i.name}**: [atom-runner](https://atom.io/packages/atom-runner) is not installed`,{dismissable:!1})},check:function(){return this.runner={path:atom.packages.resolvePackagePath("atom-runner"),active:atom.packages.isPackageLoaded("atom-runner")}}}},function(e){e.exports=JSON.parse('{"name":"language-nsis","version":"7.2.1","description":"Atom language support for NSIS, including grammar, snippets and build system","license":"MIT OR GPL-2.0","scripts":{"build":"webpack --mode production","dev":"webpack --mode none --watch","lint":"gulp lint","test":"npm run lint"},"author":{"name":"Jan T. Sott","url":"http://github.com/idleberg"},"keywords":["nsis","nullsoft","installer","setup","windows","build","build tool","compiler","grammar","language syntax"],"repository":{"type":"git","url":"https://github.com/idleberg/atom-language-nsis.git"},"main":"./lib/main","engines":{"atom":">=1.19.0 <2.0.0"},"package-deps":["console-panel","hyperclick","hyperclick-nsis:0.5.0","linter:2.0.0","linter-makensis:0.7.0","linter-ui-default"],"activationCommands":{"atom-workspace":["NSIS:convert-language-file","NSIS:create-.atom–build-file","NSIS:create-.atom–build-file-for-wine","NSIS:open-package-settings","NSIS:remove-default-runner","NSIS:satisfy-package-dependencies","NSIS:save-&-compile","NSIS:save-&-compile-strict","NSIS:set-default-runner","NSIS:show-compiler-flags","NSIS:show-version"]},"activationHooks":["language-nlf:grammar-used","language-nsis:grammar-used"],"consumedServices":{"console-panel":{"versions":{"^1.0.0":"consumeConsolePanel"}}},"dependencies":{"@nsis/nlf":"^0.6.1","atom-package-deps":"^5.1.0","atom-read-manifest":"^0.3.2","atom-satisfy-dependencies":"^0.2.1","atom-select-list":"^0.7.2","cson-parser":"^4.0.3","makensis":"^0.20.3","open":"^7.0.0","yaml-js":"^0.3.0"},"devDependencies":{"coffee-loader":"^0.9.0","coffeelint-stylish":"^0.1.2","coffeescript":"^2.5.0","gulp":"^4.0.2","gulp-coffeelint":"^0.6.0","gulp-debug":"^4.0.0","gulp-jsonlint":"^1.3.1","husky":"^4.0.10","webpack":"^4.41.5","webpack-cli":"^3.3.10","webpack-node-externals":"^1.7.2"},"husky":{"hooks":{"pre-commit":"npm run test"}}}')}]);
//# sourceMappingURL=main.js.map